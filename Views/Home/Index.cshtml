@{
    ViewData["Title"] = "Home Page";
}

<img id="targetImage" src="" width="200" height="200" style="border: 1px solid black" />

<script src="https://cdn.jsdelivr.net/npm/@@aspnet/signalr@1.1.4/dist/browser/signalr.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/msgpack5@4.2.1/dist/msgpack5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@@aspnet/signalr-protocol-msgpack@1.1.0/dist/browser/signalr-protocol-msgpack.min.js"></script>
<script>
let connection = new signalR.HubConnectionBuilder()
    .withUrl("/image-stream")
    .withHubProtocol(new signalR.protocols.msgpack.MessagePackHubProtocol())
    .build();
 
connection.on('ReceiveImage', data => {
    var blob = new Blob([data], {type: "image/png"});
    var reader = new FileReader();
    reader.onload = function(event) {
	    var dataUrl = event.target.result;
        document.getElementById('targetImage').src = dataUrl;
    };
    reader.readAsDataURL(blob);
});
 
connection.start();
</script>